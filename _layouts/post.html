---
layout: default
---

<article class="post">
  <header class="post-header">
    <h1 class="post-title">{{ page.title }}</h1>
    <div class="post-meta">
      <span class="post-date">{{ page.date | date: "%d %b %Y" }}</span>
      {% if page.tags.size > 0 %}
      <span class="post-tags">
        {% for tag in page.tags %}
        <span class="tag">{{ tag }}</span>
        {% endfor %}
      </span>
      {% endif %}
    </div>
  </header>

{% if page.audio %}
  <div class="audio-section">
    <div class="audio-header">
      <h3>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="audio-icon">
          <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path>
          <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
          <line x1="12" x2="12" y1="19" y2="22"></line>
        </svg>
        {{ page.audio.title | default: "Escucha este texto" }}
      </h3>
      {% if page.audio.duration %}
      <span class="audio-duration">{{ page.audio.duration }}</span>
      {% endif %}
    </div>
    {% if page.audio.description %}
    <p class="audio-description">{{ page.audio.description }}</p>
    {% endif %}
    <audio controls class="audio-player">
      <source src="{{ page.audio.file }}" type="audio/mpeg">
      Tu navegador no soporta el elemento de audio.
    </audio>
  </div>
{% endif %}
  
  {% if page.image %}
  <div class="post-featured-image">
    <img src="{{ page.image }}" alt="{{ page.title }}">
  </div>
  {% endif %}
  
  <div class="post-content">
    {{ content }}
  </div>
  
  {% if page.author %}
  <div class="author-section">
    <div class="author-avatar">
      <img src="/assets/img/avatar.jpg" alt="{{ page.author }}">
    </div>
    <div class="author-info">
      <h4 class="author-name">{{ page.author }}</h4>
      <p class="author-bio">Ingeniero, artemarcialista, home barista, dj y escritor con la ayuda de IA.</p>
    </div>
  </div>
  {% endif %}
  
  <footer class="post-footer">
    <a href="/textos" class="back-link">‚Üê Volver a todos los textos</a>
  </footer>
</article>

<section class="related-posts">
  <h3>Textos relacionados</h3>
  <div class="related-posts-grid">
    {% assign maxRelated = 3 %}
    {% assign minCommonTags = 1 %}
    {% assign maxRelatedCounter = 0 %}
    
    {% for post in site.posts %}
      {% assign sameTagCount = 0 %}
      {% for tag in post.tags %}
        {% if post.url != page.url %}
          {% if page.tags contains tag %}
            {% assign sameTagCount = sameTagCount | plus: 1 %}
          {% endif %}
        {% endif %}
      {% endfor %}
      
      {% if sameTagCount >= minCommonTags and maxRelatedCounter < maxRelated %}
        <div class="post-item">
          <a href="{{ post.url }}">
            <div class="post-thumb" style="background-image: url('{{ post.image }}');"></div>
            <div class="post-content">
              <h2>{{ post.title }}</h2>
              <p class="date">{{ post.date | date: "%d %b %Y" }}</p>
            </div>
          </a>
        </div>
        {% assign maxRelatedCounter = maxRelatedCounter | plus: 1 %}
      {% endif %}
    {% endfor %}
    
    {% if maxRelatedCounter == 0 %}
      {% for post in site.posts limit:3 %}
        {% if post.url != page.url %}
          <div class="post-item">
            <a href="{{ post.url }}">
              <div class="post-thumb" style="background-image: url('{{ post.image }}');"></div>
              <div class="post-content">
                <h2>{{ post.title }}</h2>
                <p class="date">{{ post.date | date: "%d %b %Y" }}</p>
              </div>
            </a>
          </div>
        {% endif %}
      {% endfor %}
    {% endif %}
  </div>
</section>
